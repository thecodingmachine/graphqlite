<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Authentication and authorization · GraphQLite</title><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="generator" content="Docusaurus"/><meta name="description" content="You might not want to expose your GraphQL API to anyone. Or you might want to keep some queries/mutations or fields"/><meta name="docsearch:version" content="4.1"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Authentication and authorization · GraphQLite"/><meta property="og:type" content="website"/><meta property="og:url" content="https://graphqlite.thecodingmachine.io/"/><meta property="og:description" content="You might not want to expose your GraphQL API to anyone. Or you might want to keep some queries/mutations or fields"/><meta property="og:image" content="https://graphqlite.thecodingmachine.io/img/docusaurus.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://graphqlite.thecodingmachine.io/img/docusaurus.png"/><link rel="shortcut icon" href="/img/logo.svg"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/darcula.min.css"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-10196481-8', 'auto');
              ga('send', 'pageview');
            </script><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/graphqlite.svg" alt="GraphQLite"/><h2 class="headerTitleWithLogo">GraphQLite</h2></a><a href="/versions"><h3>4.1</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/getting-started" target="_self">Docs</a></li><li class=""><a href="https://github.com/thecodingmachine/graphqlite" target="_self">GitHub</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Security</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Introduction</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/features">GraphQLite</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Installation</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/getting-started">Getting Started</a></li><li class="navListItem"><a class="navItem" href="/docs/symfony-bundle">Symfony bundle</a></li><li class="navListItem"><a class="navItem" href="/docs/laravel-package">Laravel package</a></li><li class="navListItem"><a class="navItem" href="/docs/universal_service_providers">Universal service providers</a></li><li class="navListItem"><a class="navItem" href="/docs/other-frameworks">Other frameworks / No framework</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Usage</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/queries">Queries</a></li><li class="navListItem"><a class="navItem" href="/docs/mutations">Mutations</a></li><li class="navListItem"><a class="navItem" href="/docs/type_mapping">Type mapping</a></li><li class="navListItem"><a class="navItem" href="/docs/autowiring">Autowiring services</a></li><li class="navListItem"><a class="navItem" href="/docs/extend_type">Extending a type</a></li><li class="navListItem"><a class="navItem" href="/docs/external_type_declaration">External type declaration</a></li><li class="navListItem"><a class="navItem" href="/docs/input-types">Input types</a></li><li class="navListItem"><a class="navItem" href="/docs/inheritance-interfaces">Inheritance and interfaces</a></li><li class="navListItem"><a class="navItem" href="/docs/error-handling">Error handling</a></li><li class="navListItem"><a class="navItem" href="/docs/validation">User input validation</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Security</h3><ul class=""><li class="navListItem navListItemActive"><a class="navItem" href="/docs/authentication_authorization">Authentication and authorization</a></li><li class="navListItem"><a class="navItem" href="/docs/fine-grained-security">Fine grained security</a></li><li class="navListItem"><a class="navItem" href="/docs/implementing-security">Connecting security to your framework</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Performance</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/query-plan">Query plan</a></li><li class="navListItem"><a class="navItem" href="/docs/prefetch-method">Prefetching records</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Advanced</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/file-uploads">File uploads</a></li><li class="navListItem"><a class="navItem" href="/docs/pagination">Pagination</a></li><li class="navListItem"><a class="navItem" href="/docs/custom-types">Custom types</a></li><li class="navListItem"><a class="navItem" href="/docs/field-middlewares">Custom annotations</a></li><li class="navListItem"><a class="navItem" href="/docs/argument-resolving">Custom argument resolving</a></li><li class="navListItem"><a class="navItem" href="/docs/extend_input_type">Extending an input type</a></li><li class="navListItem"><a class="navItem" href="/docs/multiple_output_types">Class with multiple output types</a></li><li class="navListItem"><a class="navItem" href="/docs/symfony-bundle-advanced">Symfony specific features</a></li><li class="navListItem"><a class="navItem" href="/docs/laravel-package-advanced">Laravel specific features</a></li><li class="navListItem"><a class="navItem" href="/docs/internals">Internals</a></li><li class="navListItem"><a class="navItem" href="/docs/troubleshooting">Troubleshooting</a></li><li class="navListItem"><a class="navItem" href="/docs/migrating">Migrating</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Reference</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/doctrine-annotations-attributes">Annotations VS Attributes</a></li><li class="navListItem"><a class="navItem" href="/docs/annotations_reference">Annotations reference</a></li><li class="navListItem"><a class="navItem" href="/docs/semver">Semantic versioning</a></li><li class="navListItem"><a class="navItem" href="/docs/changelog">Changelog</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/thecodingmachine/graphqlite/edit/master/docs/authentication_authorization.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">Authentication and authorization</h1></header><article><div><span><p>You might not want to expose your GraphQL API to anyone. Or you might want to keep some queries/mutations or fields
reserved to some users.</p>
<p>GraphQLite offers some control over what a user can do with your API. You can restrict access to resources:</p>
<ul>
<li>based on authentication using the <a href="#logged-and-right-annotations"><code>@Logged</code> annotation</a> (restrict access to logged users)</li>
<li>based on authorization using the <a href="#logged-and-right-annotations"><code>@Right</code> annotation</a> (restrict access to logged users with certain rights).</li>
<li>based on fine-grained authorization using the <a href="/docs/fine-grained-security"><code>@Security</code> annotation</a> (restrict access for some given resources to some users).</li>
</ul>
<div class="alert alert-info">
GraphQLite does not have its own security mechanism.
Unless you're using our Symfony Bundle or our Laravel package, it is up to you to connect this feature to your framework's security mechanism.<br>
See <a href="implementing-security.md">Connecting GraphQLite to your framework's security module</a>.
</div>
<h2><a class="anchor" aria-hidden="true" id="logged-and-right-annotations"></a><a href="#logged-and-right-annotations" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>@Logged</code> and <code>@Right</code> annotations</h2>
<p>GraphQLite exposes two annotations (<code>@Logged</code> and <code>@Right</code>) that you can use to restrict access to a resource.</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-229-tab-230" class="nav-link active" data-group="group_229" data-tab="tab-group-229-content-230">PHP 8+</div><div id="tab-group-229-tab-231" class="nav-link" data-group="group_229" data-tab="tab-group-229-content-231">PHP 7+</div></div><div class="tab-content"><div id="tab-group-229-content-230" class="tab-pane active" data-group="group_229" tabindex="-1"><div><span><pre><code class="hljs css language-php"><span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Controller</span>;<br /><br /><span class="hljs-keyword">use</span> <span class="hljs-title">TheCodingMachine</span>\<span class="hljs-title">GraphQLite</span>\<span class="hljs-title">Annotations</span>\<span class="hljs-title">Query</span>;<br /><span class="hljs-keyword">use</span> <span class="hljs-title">TheCodingMachine</span>\<span class="hljs-title">GraphQLite</span>\<span class="hljs-title">Annotations</span>\<span class="hljs-title">Logged</span>;<br /><span class="hljs-keyword">use</span> <span class="hljs-title">TheCodingMachine</span>\<span class="hljs-title">GraphQLite</span>\<span class="hljs-title">Annotations</span>\<span class="hljs-title">Right</span>;<br /><br /><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserController</span><br /></span>{<br />    <span class="hljs-comment">/**<br />     * <span class="hljs-doctag">@return</span> User[]<br />     */</span><br />    <span class="hljs-comment">#[Query]</span><br />    <span class="hljs-comment">#[Logged]</span><br />    <span class="hljs-comment">#[Right("CAN_VIEW_USER_LIST")]</span><br />    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">users</span><span class="hljs-params">(int $limit, int $offset)</span>: <span class="hljs-title">array</span><br />    </span>{<br />        <span class="hljs-comment">// ...</span><br />    }<br />}<br /></code></pre>
</span></div></div><div id="tab-group-229-content-231" class="tab-pane" data-group="group_229" tabindex="-1"><div><span><pre><code class="hljs css language-php"><span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Controller</span>;<br /><br /><span class="hljs-keyword">use</span> <span class="hljs-title">TheCodingMachine</span>\<span class="hljs-title">GraphQLite</span>\<span class="hljs-title">Annotations</span>\<span class="hljs-title">Query</span>;<br /><span class="hljs-keyword">use</span> <span class="hljs-title">TheCodingMachine</span>\<span class="hljs-title">GraphQLite</span>\<span class="hljs-title">Annotations</span>\<span class="hljs-title">Logged</span>;<br /><span class="hljs-keyword">use</span> <span class="hljs-title">TheCodingMachine</span>\<span class="hljs-title">GraphQLite</span>\<span class="hljs-title">Annotations</span>\<span class="hljs-title">Right</span>;<br /><br /><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserController</span><br /></span>{<br />    <span class="hljs-comment">/**<br />     * <span class="hljs-doctag">@Query</span><br />     * <span class="hljs-doctag">@Logged</span><br />     * <span class="hljs-doctag">@Right</span>("CAN_VIEW_USER_LIST")<br />     * <span class="hljs-doctag">@return</span> User[]<br />     */</span><br />    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">users</span><span class="hljs-params">(int $limit, int $offset)</span>: <span class="hljs-title">array</span><br />    </span>{<br />        <span class="hljs-comment">// ...</span><br />    }<br />}<br /></code></pre>
</span></div></div></div></div>
<p>In the example above, the query <code>users</code> will only be available if the user making the query is logged AND if he
has the <code>CAN_VIEW_USER_LIST</code> right.</p>
<p><code>@Logged</code> and <code>@Right</code> annotations can be used next to:</p>
<ul>
<li><code>@Query</code> annotations</li>
<li><code>@Mutation</code> annotations</li>
<li><code>@Field</code> annotations</li>
</ul>
<div class="alert alert-info">By default, if a user tries to access an unauthorized query/mutation/field, an error is raised and the query fails.</div>
<h2><a class="anchor" aria-hidden="true" id="not-throwing-errors"></a><a href="#not-throwing-errors" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Not throwing errors</h2>
<p>If you do not want an error to be thrown when a user attempts to query a field/query/mutation he has no access to, you can use the <code>@FailWith</code> annotation.</p>
<p>The <code>@FailWith</code> annotation contains the value that will be returned for users with insufficient rights.</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-232-tab-233" class="nav-link active" data-group="group_232" data-tab="tab-group-232-content-233">PHP 8+</div><div id="tab-group-232-tab-234" class="nav-link" data-group="group_232" data-tab="tab-group-232-content-234">PHP 7+</div></div><div class="tab-content"><div id="tab-group-232-content-233" class="tab-pane active" data-group="group_232" tabindex="-1"><div><span><pre><code class="hljs css language-php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserController</span><br /></span>{<br />    <span class="hljs-comment">/**<br />     * If a user is not logged or if the user has not the right "CAN_VIEW_USER_LIST",<br />     * the value returned will be "null".<br />     *<br />     * <span class="hljs-doctag">@return</span> User[]<br />     */</span><br />    <span class="hljs-comment">#[Query]</span><br />    <span class="hljs-comment">#[Logged]</span><br />    <span class="hljs-comment">#[Right("CAN_VIEW_USER_LIST")]</span><br />    <span class="hljs-comment">#[FailWith(value: null)]</span><br />    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">users</span><span class="hljs-params">(int $limit, int $offset)</span>: <span class="hljs-title">array</span><br />    </span>{<br />        <span class="hljs-comment">// ...</span><br />    }<br />}<br /></code></pre>
</span></div></div><div id="tab-group-232-content-234" class="tab-pane" data-group="group_232" tabindex="-1"><div><span><pre><code class="hljs css language-php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserController</span><br /></span>{<br />    <span class="hljs-comment">/**<br />     * If a user is not logged or if the user has not the right "CAN_VIEW_USER_LIST",<br />     * the value returned will be "null".<br />     *<br />     * <span class="hljs-doctag">@Query</span><br />     * <span class="hljs-doctag">@Logged</span><br />     * <span class="hljs-doctag">@Right</span>("CAN_VIEW_USER_LIST")<br />     * <span class="hljs-doctag">@FailWith</span>(null)<br />     * <span class="hljs-doctag">@return</span> User[]<br />     */</span><br />    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">users</span><span class="hljs-params">(int $limit, int $offset)</span>: <span class="hljs-title">array</span><br />    </span>{<br />        <span class="hljs-comment">// ...</span><br />    }<br />}<br /></code></pre>
</span></div></div></div></div>
<h2><a class="anchor" aria-hidden="true" id="injecting-the-current-user-as-a-parameter"></a><a href="#injecting-the-current-user-as-a-parameter" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Injecting the current user as a parameter</h2>
<p>Use the <code>@InjectUser</code> annotation to get an instance of the current user logged in.</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-235-tab-236" class="nav-link active" data-group="group_235" data-tab="tab-group-235-content-236">PHP 8+</div><div id="tab-group-235-tab-237" class="nav-link" data-group="group_235" data-tab="tab-group-235-content-237">PHP 7+</div></div><div class="tab-content"><div id="tab-group-235-content-236" class="tab-pane active" data-group="group_235" tabindex="-1"><div><span><pre><code class="hljs css language-php"><span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Controller</span>;<br /><br /><span class="hljs-keyword">use</span> <span class="hljs-title">TheCodingMachine</span>\<span class="hljs-title">GraphQLite</span>\<span class="hljs-title">Annotations</span>\<span class="hljs-title">Query</span>;<br /><span class="hljs-keyword">use</span> <span class="hljs-title">TheCodingMachine</span>\<span class="hljs-title">GraphQLite</span>\<span class="hljs-title">Annotations</span>\<span class="hljs-title">InjectUser</span>;<br /><br /><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ProductController</span><br /></span>{<br />    <span class="hljs-comment">/**<br />     * <span class="hljs-doctag">@Query</span><br />     * <span class="hljs-doctag">@return</span> Product<br />     */</span><br />    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">product</span><span class="hljs-params">(<br />            int $id,<br />            #[InjectUser] <br />            User $user<br />        )</span>: <span class="hljs-title">Product</span><br />    </span>{<br />        <span class="hljs-comment">// ...</span><br />    }<br />}<br /></code></pre>
</span></div></div><div id="tab-group-235-content-237" class="tab-pane" data-group="group_235" tabindex="-1"><div><span><pre><code class="hljs css language-php"><span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Controller</span>;<br /><br /><span class="hljs-keyword">use</span> <span class="hljs-title">TheCodingMachine</span>\<span class="hljs-title">GraphQLite</span>\<span class="hljs-title">Annotations</span>\<span class="hljs-title">Query</span>;<br /><span class="hljs-keyword">use</span> <span class="hljs-title">TheCodingMachine</span>\<span class="hljs-title">GraphQLite</span>\<span class="hljs-title">Annotations</span>\<span class="hljs-title">InjectUser</span>;<br /><br /><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ProductController</span><br /></span>{<br />    <span class="hljs-comment">/**<br />     * <span class="hljs-doctag">@Query</span><br />     * <span class="hljs-doctag">@InjectUser</span>(for="$user") <br />     * <span class="hljs-doctag">@return</span> Product<br />     */</span><br />    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">product</span><span class="hljs-params">(int $id, User $user)</span>: <span class="hljs-title">Product</span><br />    </span>{<br />        <span class="hljs-comment">// ...</span><br />    }<br />}<br /></code></pre>
</span></div></div></div></div>
<p>The <code>@InjectUser</code> annotation can be used next to:</p>
<ul>
<li><code>@Query</code> annotations</li>
<li><code>@Mutation</code> annotations</li>
<li><code>@Field</code> annotations</li>
</ul>
<p>The object injected as the current user depends on your framework. It is in fact the object returned by the
<a href="/docs/implementing-security">&quot;authentication service&quot; configured in GraphQLite</a>.</p>
<h2><a class="anchor" aria-hidden="true" id="hiding-fields--queries--mutations"></a><a href="#hiding-fields--queries--mutations" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Hiding fields / queries / mutations</h2>
<p>By default, a user analysing the GraphQL schema can see all queries/mutations/types available.
Some will be available to him and some won't.</p>
<p>If you want to add an extra level of security (or if you want your schema to be kept secret to unauthorized users),
you can use the <code>@HideIfUnauthorized</code> annotation.</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-238-tab-239" class="nav-link active" data-group="group_238" data-tab="tab-group-238-content-239">PHP 8+</div><div id="tab-group-238-tab-240" class="nav-link" data-group="group_238" data-tab="tab-group-238-content-240">PHP 7+</div></div><div class="tab-content"><div id="tab-group-238-content-239" class="tab-pane active" data-group="group_238" tabindex="-1"><div><span><pre><code class="hljs css language-php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserController</span><br /></span>{<br />    <span class="hljs-comment">/**<br />     * If a user is not logged or if the user has not the right "CAN_VIEW_USER_LIST",<br />     * the schema will NOT contain the "users" query at all (so trying to call the<br />     * "users" query will result in a GraphQL "query not found" error.<br />     *<br />     * <span class="hljs-doctag">@return</span> User[]<br />     */</span><br />    <span class="hljs-comment">#[Query]</span><br />    <span class="hljs-comment">#[Logged]</span><br />    <span class="hljs-comment">#[Right("CAN_VIEW_USER_LIST")]</span><br />    <span class="hljs-comment">#[HideIfUnauthorized]</span><br />    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">users</span><span class="hljs-params">(int $limit, int $offset)</span>: <span class="hljs-title">array</span><br />    </span>{<br />        <span class="hljs-comment">// ...</span><br />    }<br />}<br /></code></pre>
</span></div></div><div id="tab-group-238-content-240" class="tab-pane" data-group="group_238" tabindex="-1"><div><span><pre><code class="hljs css language-php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserController</span><br /></span>{<br />    <span class="hljs-comment">/**<br />     * If a user is not logged or if the user has not the right "CAN_VIEW_USER_LIST",<br />     * the schema will NOT contain the "users" query at all (so trying to call the<br />     * "users" query will result in a GraphQL "query not found" error.<br />     *<br />     * <span class="hljs-doctag">@Query</span><br />     * <span class="hljs-doctag">@Logged</span><br />     * <span class="hljs-doctag">@Right</span>("CAN_VIEW_USER_LIST")<br />     * <span class="hljs-doctag">@HideIfUnauthorized</span>()<br />     * <span class="hljs-doctag">@return</span> User[]<br />     */</span><br />    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">users</span><span class="hljs-params">(int $limit, int $offset)</span>: <span class="hljs-title">array</span><br />    </span>{<br />        <span class="hljs-comment">// ...</span><br />    }<br />}<br /></code></pre>
</span></div></div></div></div>
<p>While this is the most secured mode, it can have drawbacks when working with development tools
(you need to be logged as admin to fetch the complete schema).</p>
<div class="alert alert-info">The "HideIfUnauthorized" mode was the default mode in GraphQLite 3 and is optionnal from GraphQLite 4+.</div>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/validation"><span class="arrow-prev">← </span><span>User input validation</span></a><a class="docs-next button" href="/docs/fine-grained-security"><span>Fine grained security</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#logged-and-right-annotations"><code>@Logged</code> and <code>@Right</code> annotations</a></li><li><a href="#not-throwing-errors">Not throwing errors</a></li><li><a href="#injecting-the-current-user-as-a-parameter">Injecting the current user as a parameter</a></li><li><a href="#hiding-fields--queries--mutations">Hiding fields / queries / mutations</a></li></ul></nav></div><footer class="nav-footer" id="footer"><a href="https://thecodingmachine.io/open-source" target="_blank" class="fbOpenSource"><img src="/img/tcm.png" alt="Proudly brought to you by TheCodingMachine"/></a><section class="copyright">Copyright © 2017-2021 TheCodingMachine</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '8fcce617e281864dc03c68d17f6206db',
                indexName: 'graphqlite_thecodingmachine',
                inputSelector: '#search_input_react',
                algoliaOptions: {}
              });
            </script></body></html>