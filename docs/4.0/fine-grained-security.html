<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.5">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-10196481-8"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-10196481-8",{})</script>
<link rel="search" type="application/opensearchdescription+xml" title="GraphQLite" href="/opensearch.xml">
<script src="https://buttons.github.io/buttons.js"></script>
<script src="https://unpkg.com/mermaid@8.0.0/dist/mermaid.min.js"></script><title data-react-helmet="true">Fine grained security | GraphQLite</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:image" content="https://graphqlite.thecodingmachine.io/img/graphqlite.svg"><meta data-react-helmet="true" name="twitter:image" content="https://graphqlite.thecodingmachine.io/img/graphqlite.svg"><meta data-react-helmet="true" property="og:url" content="https://graphqlite.thecodingmachine.io/docs/4.0/fine-grained-security"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="4.0"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-4.0"><meta data-react-helmet="true" property="og:title" content="Fine grained security | GraphQLite"><meta data-react-helmet="true" name="description" content="If the @Logged and @Right annotations are not"><meta data-react-helmet="true" property="og:description" content="If the @Logged and @Right annotations are not"><link data-react-helmet="true" rel="shortcut icon" href="/img/logo.svg"><link data-react-helmet="true" rel="canonical" href="https://graphqlite.thecodingmachine.io/docs/4.0/fine-grained-security"><link data-react-helmet="true" rel="alternate" href="https://graphqlite.thecodingmachine.io/docs/4.0/fine-grained-security" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://graphqlite.thecodingmachine.io/docs/4.0/fine-grained-security" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.28218bec.css">
<link rel="preload" href="/assets/js/runtime~main.85d0274e.js" as="script">
<link rel="preload" href="/assets/js/main.961269b8.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbar--dark"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/graphqlite.svg" alt="GraphQLite" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/graphqlite.svg" alt="GraphQLite" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">GraphQLite</b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/thecodingmachine/graphqlite" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" href="/docs/4.0">4.0</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/next/fine-grained-security">Next</a></li><li><a class="dropdown__link" href="/docs/fine-grained-security">4.3</a></li><li><a class="dropdown__link" href="/docs/4.2/fine-grained-security">4.2</a></li><li><a class="dropdown__link" href="/docs/4.1/fine-grained-security">4.1</a></li><li><a aria-current="page" class="dropdown__link navbar__link--active" href="/docs/4.0/fine-grained-security">4.0</a></li><li><a class="dropdown__link" href="/docs/3.0/fine-grained-security">3.0</a></li></ul></div><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="searchBox_1Doo"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Introduction</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Installation</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Usage</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Security</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/4.0/authentication_authorization">Authentication and authorization</a></li><li class="menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/4.0/fine-grained-security">Fine grained security</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/4.0/implementing-security">Connecting security to your framework</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Performance</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Advanced</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Reference</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for GraphQLite <b>4.0</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/docs/fine-grained-security">latest version</a></b> (4.3).</div></div><div class="docItemContainer_33ec"><article><span class="badge badge--secondary">Version: 4.0</span><div class="tocCollapsible_1PrD tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="markdown"><header><h1>Fine grained security</h1></header><p>If the <a href="/docs/4.0/authentication_authorization#logged-and-right-annotations"><code>@Logged</code> and <code>@Right</code> annotations</a> are not
granular enough for your needs, you can use the advanced <code>@Security</code> annotation.</p><p>Using the <code>@Security</code> annotation, you can write an <em>expression</em> that can contain custom logic. For instance:</p><ul><li>Check that a user can access a given resource</li><li>Check that a user has one right or another right</li><li>...</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="using-the-security-annotation"></a>Using the @Security annotation<a class="hash-link" href="#using-the-security-annotation" title="Direct link to heading">#</a></h2><p>The <code>@Security</code> annotation is very flexible: it allows you to pass an expression that can contains custom logic:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly php"><pre tabindex="0" class="prism-code language-php codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">use TheCodingMachine\GraphQLite\Annotations\Security;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">// ...</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @Query</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @Security(&quot;is_granted(&#x27;ROLE_ADMIN&#x27;) or is_granted(&#x27;POST_SHOW&#x27;, post)&quot;)</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span></span><span class="token-line" style="color:#393A34"><span class="token plain">public function getPost(Post $post): array</span></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ...</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The <em>expression</em> defined in the <code>@Security</code> annotation must conform to <a href="https://symfony.com/doc/4.4/components/expression_language/syntax.html" target="_blank" rel="noopener noreferrer">Symfony&#x27;s Expression Language syntax</a></p><div class="alert alert--info">If you are a Symfony user, you might already be used to the <code>@Security</code> annotation. Most of the inspiration of this annotation comes from Symfony. Warning though! GraphQLite&#x27;s <code>@Security</code> annotation and Symfony&#x27;s <code>@Security</code> annotation are slightly different. Especially, the two annotations do not live in the same namespace!</div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="the-is_granted-function"></a>The <code>is_granted</code> function<a class="hash-link" href="#the-is_granted-function" title="Direct link to heading">#</a></h2><p>Use the <code>is_granted</code> function to check if a user has a special right.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly php"><pre tabindex="0" class="prism-code language-php codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">@Security(&quot;is_granted(&#x27;ROLE_ADMIN&#x27;)&quot;)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>is similar to</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly php"><pre tabindex="0" class="prism-code language-php codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">@Right(&quot;ROLE_ADMIN&quot;)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>In addition, the <code>is_granted</code> function accepts a second optional parameter: the &quot;scope&quot; of the right.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly php"><pre tabindex="0" class="prism-code language-php codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @Query</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @Security(&quot;is_granted(&#x27;POST_SHOW&#x27;, post)&quot;)</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span></span><span class="token-line" style="color:#393A34"><span class="token plain">public function getPost(Post $post): array</span></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ...</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>In the example above, the <code>getPost</code> method can be called only if the logged user has the &#x27;POST_SHOW&#x27; permission on the
<code>$post</code> object. You can notice that the <code>$post</code> object comes from the parameters.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="accessing-method-parameters"></a>Accessing method parameters<a class="hash-link" href="#accessing-method-parameters" title="Direct link to heading">#</a></h2><p>All parameters passed to the method can be accessed in the <code>@Security</code> expression.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly php"><pre tabindex="0" class="prism-code language-php codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @Query</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @Security(&quot;startDate &lt; endDate&quot;, statusCode=400, message=&quot;End date must be after start date&quot;)</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span></span><span class="token-line" style="color:#393A34"><span class="token plain">public function getPosts(DateTimeImmutable $startDate, DateTimeImmutable $endDate): array</span></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ...</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>In the example above, we tweak a bit the Security annotation purpose to do simple input validation.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="setting-http-code-and-error-message"></a>Setting HTTP code and error message<a class="hash-link" href="#setting-http-code-and-error-message" title="Direct link to heading">#</a></h2><p>You can use the <code>statusCode</code> and <code>message</code> attributes to set the HTTP code and GraphQL error message.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly php"><pre tabindex="0" class="prism-code language-php codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @Query</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @Security(&quot;is_granted(&#x27;POST_SHOW&#x27;, post)&quot;, statusCode=404, message=&quot;Post not found (let&#x27;s pretend the post does not exists!)&quot;)</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span></span><span class="token-line" style="color:#393A34"><span class="token plain">public function getPost(Post $post): array</span></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ...</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Note: since a single GraphQL call contain many errors, 2 errors might have conflicting HTTP status code.
The resulting status code is up to the GraphQL middleware you use. Most of the time, the status code with the
higher error code will be returned.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="setting-a-default-value"></a>Setting a default value<a class="hash-link" href="#setting-a-default-value" title="Direct link to heading">#</a></h2><p>If you do not want an error to be thrown when the security condition is not met, you can use the <code>failWith</code> attribute
to set a default value.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly php"><pre tabindex="0" class="prism-code language-php codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @Field</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @Security(&quot;is_granted(&#x27;CAN_SEE_MARGIN&#x27;, this)&quot;, failWith=null)</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span></span><span class="token-line" style="color:#393A34"><span class="token plain">public function getMargin(): float</span></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ...</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The <code>failWith</code> attribute behaves just like the <a href="/docs/4.0/authentication_authorization#not-throwing-errors"><code>@FailWith</code> annotation</a>
but for a given <code>@Security</code> annotation.</p><p>You cannot use the <code>failWith</code> attribute along <code>statusCode</code> or <code>message</code> attributes.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="accessing-the-user"></a>Accessing the user<a class="hash-link" href="#accessing-the-user" title="Direct link to heading">#</a></h2><p>You can use the <code>user</code> variable to access the currently logged user.
You can use the <code>is_logged()</code> function to check if a user is logged or not.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly php"><pre tabindex="0" class="prism-code language-php codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @Query</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @Security(&quot;is_logged() &amp;&amp; user.age &gt; 18&quot;)</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span></span><span class="token-line" style="color:#393A34"><span class="token plain">public function getNSFWImages(): array</span></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ...</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="accessing-the-current-object"></a>Accessing the current object<a class="hash-link" href="#accessing-the-current-object" title="Direct link to heading">#</a></h2><p>You can use the <code>this</code> variable to access any (public) property / method of the current class.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly php"><pre tabindex="0" class="prism-code language-php codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">class Post {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @Field</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @Security(&quot;this.canAccessBody(user)&quot;)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    public function getBody(): array</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        // ...</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    public function canAccessBody(User $user): bool</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Some custom logic here</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="available-scope"></a>Available scope<a class="hash-link" href="#available-scope" title="Direct link to heading">#</a></h2><p>The <code>@Security</code> annotation can be used in any query, mutation or field, so anywhere you have a <code>@Query</code>, <code>@Mutation</code>
or <code>@Field</code> annotation.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="how-to-restrict-access-to-a-given-resource"></a>How to restrict access to a given resource<a class="hash-link" href="#how-to-restrict-access-to-a-given-resource" title="Direct link to heading">#</a></h2><p>The <code>is_granted</code> method can be used to restrict access to a specific resource.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly php"><pre tabindex="0" class="prism-code language-php codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">@Security(&quot;is_granted(&#x27;POST_SHOW&#x27;, post)&quot;)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>If you are wondering how to configure these fine-grained permissions, this is not something that GraphQLite handles
itself. Instead, this depends on the framework you are using.</p><p>If you are using Symfony, you will <a href="https://symfony.com/doc/current/security/voters.html" target="_blank" rel="noopener noreferrer">create a custom voter</a>.</p><p>If you are using Laravel, you will <a href="https://laravel.com/docs/6.x/authorization" target="_blank" rel="noopener noreferrer">create a Gate or a Policy</a>.</p><p>If you are using another framework, you need to know that the <code>is_granted</code> function simply forwards the call to
the <code>isAllowed</code> method of the configured <code>AuthorizationSerice</code>. See <a href="/docs/4.0/implementing-security">Connecting GraphQLite to your framework&#x27;s security module
</a> for more details</p></div><footer class="docusaurus-mt-lg"><div class="row"><div class="col"><a href="https://github.com/thecodingmachine/graphqlite/edit/master/website/versioned_docs/version-4.0/fine-grained-security.mdx" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_">Last updated on <b><time datetime="2021-08-31T12:16:29.000Z">8/31/2021</time></b> by <b>Jacob Thomason</b></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/4.0/authentication_authorization"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Authentication and authorization</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/4.0/implementing-security"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Connecting security to your framework Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#using-the-security-annotation" class="table-of-contents__link">Using the @Security annotation</a></li><li><a href="#the-is_granted-function" class="table-of-contents__link">The <code>is_granted</code> function</a></li><li><a href="#accessing-method-parameters" class="table-of-contents__link">Accessing method parameters</a></li><li><a href="#setting-http-code-and-error-message" class="table-of-contents__link">Setting HTTP code and error message</a></li><li><a href="#setting-a-default-value" class="table-of-contents__link">Setting a default value</a></li><li><a href="#accessing-the-user" class="table-of-contents__link">Accessing the user</a></li><li><a href="#accessing-the-current-object" class="table-of-contents__link">Accessing the current object</a></li><li><a href="#available-scope" class="table-of-contents__link">Available scope</a></li><li><a href="#how-to-restrict-access-to-a-given-resource" class="table-of-contents__link">How to restrict access to a given resource</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://github.com/thecodingmachine/graphqlite" target="_blank" rel="noopener noreferrer" class="footerLogoLink_MyFc"><img src="/img/graphqlite.svg" alt="" class="themedImage_1VuW themedImage--light_3UqQ footer__logo"><img src="/img/graphqlite.svg" alt="" class="themedImage_1VuW themedImage--dark_hz6m footer__logo"></a></div></div></div></footer></div>
<script src="/assets/js/runtime~main.85d0274e.js"></script>
<script src="/assets/js/main.961269b8.js"></script>
</body>
</html>